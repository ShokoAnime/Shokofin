<div id="ShokoConfigPage" data-role="page" class="page type-interior pluginConfigurationPage" data-require="emby-input,emby-button,emby-select,emby-checkbox" data-controller="__plugin/ShokoController.js">
    <div data-role="content">
        <div class="content-primary">
            <form id="ShokoConfigForm">
                <div class="verticalSection verticalSection-extrabottompadding">
                    <div class="sectionTitleContainer flex align-items-center">
                        <h2 class="sectionTitle">Shoko</h2>
                        <a is="emby-linkbutton" rel="noopener noreferrer" class="raised button-alt headerHelpButton emby-button" target="_blank" href="https://docs.shokoanime.com/shokofin/configuration/">Help</a>
                    </div>
                    <fieldset id="ConnectionSection" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>Connection Settings</h3>
                        </legend>
                        <div class="inputContainer inputContainer-withDescription">
                            <input is="emby-input" type="text" id="Url" required label="Host:" />
                            <div class="fieldDescription">This is the URL leading to where Shoko is running. You can input a full url, or just the dns name/ip.</div>
                        </div>
                        <div class="inputContainer inputContainer-withDescription">
                            <input is="emby-input" type="text" id="Username" required label="Username:" />
                            <div class="fieldDescription">The user should be an administrator in Shoko, preferably without any filtering applied.</div>
                        </div>
                        <div id="ConnectionSetContainer">
                            <div class="inputContainer inputContainer-withDescription">
                                <input is="emby-input" type="password" id="Password" label="Password:" />
                                <div class="fieldDescription">The password for account. It can be empty.</div>
                            </div>
                            <button is="emby-button" type="submit" class="raised button-submit block emby-button">
                                <span>Connect</span>
                            </button>
                            <div class="fieldDescription">Establish a connection to Shoko Server using the provided credentials.</div>
                        </div>
                        <div id="ConnectionResetContainer" hidden>
                            <div class="inputContainer inputContainer-withDescription">
                                <input is="emby-input" type="text" id="ServerVersion" label="Server Version:" disabled readonly value="Unknown Version" />
                                <div class="fieldDescription">The version of Shoko Server we're connected to.</div>
                            </div>
                            <button is="emby-button" type="submit" name="reset-connection" class="raised block emby-button">
                                <span>Reset Connection</span>
                            </button>
                            <div class="fieldDescription">Reset the connection. Be sure to stop any tasks using this plugin before you press the button.</div>
                        </div>
                    </fieldset>
                    <fieldset id="MetadataSection" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>Metadata Settings</h3>
                        </legend>
                        <div class="selectContainer selectContainer-withDescription">
                            <label class="selectLabel" for="TitleMainType">Main title source:</label>
                            <select is="emby-select" id="TitleMainType" name="TitleMainType" class="emby-select-withcolor emby-select">
                                <option value="Default">Let Shoko decide the title</option>
                                <option value="MetadataPreferred">Use the preferred library metadata language</option>
                                <option value="Origin">Use the language from country of origin</option>
                                <option value="Main">Use the main title on AniDB</option>
                            </select>
                            <div class="fieldDescription selectFieldDescription">How to select the main title for each item. The plugin will fallback to the default title if no title can be found in the target language.</div>
                        </div>
                        <div class="selectContainer selectContainer-withDescription">
                            <label class="selectLabel" for="TitleAlternateType">Alternate title source:</label>
                            <select is="emby-select" id="TitleAlternateType" name="TitleAlternateType" class="emby-select-withcolor emby-select">
                                <option value="Default">Let Shoko decide the title</option>
                                <option value="MetadataPreferred">Use the preferred library metadata language</option>
                                <option value="Origin">Use the language from country of origin</option>
                                <option value="Main">Use the main title on AniDB</option>
                                <option value="Ignore">Do not use alternate titles</option>
                            </select>
                            <div class="fieldDescription selectFieldDescription">How to select the alternate title for each item. The plugin will fallback to the default title if no title can be found in the target language.</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="MarkSpecialsWhenGrouped" />
                                <span>Mark specials</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">Add a number to the title of each specials episode</div>
                        </div>
                        <div id="descriptionSourceList" style="margin-bottom: 2em;">
                            <h3 class="checkboxListLabel">Description source:</h3>
                            <div class="checkboxList paperList checkboxList-paperList">
                                <div class="listItem descriptionSourceItem sortableOption" data-descriptionsource="AniDb">
                                    <label class="listItemCheckboxContainer"><input class="chkDescriptionSource" type="checkbox" is="emby-checkbox" data-descriptionsource="AniDb"><span></span></label>
                                    <div class="listItemBody"><h3 class="listItemBodyText">AniDB</h3></div>
                                    <button type="button" is="paper-icon-button-light" title="Down" class="btnSortableMoveDown btnSortable"><span class="material-icons keyboard_arrow_down" aria-hidden="true"></span></button>
                                </div>
                                <div class="listItem descriptionSourceItem sortableOption" data-descriptionsource="TvDb">
                                    <label class="listItemCheckboxContainer"><input class="chkDescriptionSource" type="checkbox" is="emby-checkbox" data-descriptionsource="TvDb"><span></span></label>
                                    <div class="listItemBody"><h3 class="listItemBodyText">TVDB</h3></div>
                                    <button type="button" is="paper-icon-button-light" title="Up" class="btnSortableMoveUp btnSortable"><span class="material-icons keyboard_arrow_up" aria-hidden="true"></span></button>
                                </div>
                                <div class="listItem descriptionSourceItem sortableOption" data-descriptionsource="TMDB">
                                    <label class="listItemCheckboxContainer"><input class="chkDescriptionSource" type="checkbox" is="emby-checkbox" data-descriptionsource="TMDB"><span></span></label>
                                    <div class="listItemBody"><h3 class="listItemBodyText">TMDB</h3></div>
                                    <button type="button" is="paper-icon-button-light" title="Up" class="btnSortableMoveUp btnSortable"><span class="material-icons keyboard_arrow_up" aria-hidden="true"></span></button>
                                </div>
                            </div>
                            <div class="fieldDescription">The metadata providers to use as the source of episode/series/season descriptions.</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="TitleAllowAny" />
                                <span>Allow any title in selected language.</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">Will add any title in the selected language if no official title is found.</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="TitleAddForMultipleEpisodes" />
                                <span>Add all metadata for multi-episode entries.</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">Will add the title and description for every episode in a multi-episode entry.</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="CleanupAniDBDescriptions" />
                                <span>Cleanup AniDB descriptions</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">Remove links and collapse multiple empty lines into one empty line</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="MinimalAniDBDescriptions" />
                                <span>Minimalistic AniDB descriptions</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">Trim any lines starting with '* ', '-- ',  '~ ', 'Note', 'Source', and/or 'Summary'</div>
                        </div>
                        <button is="emby-button" type="submit" name="settings" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </fieldset>
                    <fieldset id="LibrarySection" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>Library Settings</h3>
                        </legend>
                        <div class="fieldDescription verticalSection-extrabottompadding">
                            Placeholder description.
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="UseGroupsForShows" />
                                <span>Use shoko groups for shows</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">
                                <div>This will use Shoko's group feature to group together AniDB anime entries into show entries.</div>
                                <details style="margin-top: 0.5em">
                                    <summary style="margin-bottom: 0.25em">Pre-requirements for use.</summary>
                                    To make the most out of this feature you first need to configure your grouping in Shoko Server. You can
                                    either enable auto-grouping in the settings, or manually craft your own grouping structure, or a
                                    combination of the two where new series gets automatically assigned to a fitting group and you can
                                    override the placement if you feel it should belong elsewhere instead. For more infomation look up the
                                    <a href="https://docs.shokoanime.com/server/management">Shoko docs</a> on how to manage your groups.
                                </details>
                                <details style="margin-top: 0.5em">
                                    <summary style="margin-bottom: 0.25em">Can I use this with collections?</summary>
                                    Yes! You can use this with collections enabled, but that entails that you've configured a multi-layered
                                    structure for your groups. Because the first group layer will be used for the shows, except if 1) the group
                                    contains both movies and shows, and 2) you've separated the movies from the shows. In that case the
                                    then the first layer of groups will also be used to generate a collection for your movie(s) and show
                                    within the first layer. Also, the auto-grouping only acts on a single layer, and you need to use Shoko
                                    Desktop (or in the future, the Web UI) to create your nested structure. For more infomation look up the
                                    <a href="https://docs.shokoanime.com/server/management">Shoko docs</a> on how to manage your groups.
                                </details>
                            </div>
                        </div>
                        <div id="SeasonOrderingContainer" class="selectContainer selectContainer-withDescription" hidden>
                            <label class="selectLabel" for="SeasonOrdering">Season ordering:</label>
                            <select is="emby-select" id="SeasonOrdering" name="SeasonOrdering" class="emby-select-withcolor emby-select" disabled>
                                <option value="Default" selected>Let Shoko decide</option>
                                <option value="ReleaseDate">Order seasons by release date</option>
                                <option value="Chronological">Order seasons in chronological order</option>
                            </select>
                            <div class="fieldDescription">Determines how to order seasons within each show using the Shoko groups.</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="SeparateMovies" />
                                <span>Separate movies from shows</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">This filters out movies from the shows in your library. Disable this if you want your movies to show up as episodes within seasons of your shows instead.</div>
                        </div>
                        <div class="selectContainer selectContainer-withDescription">
                            <label class="selectLabel" for="SpecialsPlacement">Specials placement within seasons:</label>
                            <select is="emby-select" id="SpecialsPlacement" name="SpecialsPlacement" class="emby-select-withcolor emby-select">
                                <option value="AfterSeason">Always place specials after the normal episodes (Default)</option>
                                <option value="InBetweenSeasonByAirDate">Use release dates to place specials</option>
                                <option value="InBetweenSeasonByOtherData">Loosely use the TvDB/TMDB data available in Shoko to place specials</option>
                                <option value="InBetweenSeasonMixed">Either loosely use the TvDB/TMDB data available in Shoko or fallback to using release dates to place specials</option>
                                <option value="Excluded">Exclude specials from the seasons</option>
                            </select>
                            <div class="fieldDescription selectFieldDescription">Determines how specials are placed within seasons. <strong>Warning:</strong> Modifying this setting requires a recreation (read as; delete existing then create a new) of any libraries using this plugin — otherwise you <strong>will</strong> have mixed metadata.</div>
                        </div>
                        <div class="selectContainer selectContainer-withDescription">
                            <label class="selectLabel" for="CollectionGrouping">Collections:</label>
                            <select is="emby-select" id="CollectionGrouping" name="CollectionGrouping" class="emby-select-withcolor emby-select">
                                <option value="None" selected>Do not create collections</option>
                                <option value="ShokoSeries">Create collections for movies based upon Shoko's series</option>
                                <option value="ShokoGroup">Create collections for movies and shows based upon Shoko's groups and series</option>
                            </select>
                            <div class="fieldDescription">Determines how to group entities into collections.</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="AddMissingMetadata" />
                                <span>Add Missing Episodes/Seasons</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">Add the metadata for missing episodes/seasons not in the local collection.</div>
                        </div>
                        <button is="emby-button" type="submit" name="settings" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </fieldset>
                    <fieldset id="MediaFolderSection" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>Media Folder Settings</h3>
                        </legend>
                        <div class="fieldDescription verticalSection-extrabottompadding">
                            Placeholder description.
                        </div>
                        <div class="selectContainer selectContainer-withDescription">
                            <label class="selectLabel" for="MediaFolderSelector">Configure settings for:</label>
                            <select is="emby-select" id="MediaFolderSelector" name="MediaFolderSelector" value="" class="emby-select-withcolor emby-select">
                                <option value="">Default settings for new media folders</option>
                            </select>
                            <div class="fieldDescription selectFieldDescription">Select a media folder to add or modify the media folder settings for.</div>
                        </div>
                        <div id="MediaFolderDefaultSettingsContainer">
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="VirtualFileSystem" />
                                    <span>Virtual File System&trade;</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">
                                    <div>Enables the use of the Virtual File System&trade; for any new media libraries managed by the plugin.</div>
                                    <div id="WindowsSymLinkWarning1" hidden><strong>Warning</strong>: Windows users are required to <a href="https://learn.microsoft.com/en-us/windows/apps/get-started/developer-mode-features-and-debugging#use-regedit-to-enable-your-device" target="_blank" rel="noopener noreferrer">enable Developer Mode</a> then restart Jellyfin to be able to create symbolic links, a feature <strong>required</strong> to use the VFS.</div>
                                    <details style="margin-top: 0.5em">
                                        <summary style="margin-bottom: 0.25em">What does this mean?</summary>
                                        Enabling this setting should in theory make it so you won't have to think about file structure incompatibilities, since it will override your existing file structure and replace it with a layer of symbolic links managed by the plugin instead of your actual file structure.
                                        &nbsp;
                                        <strong>Do not enable this for an existing library. If you do, then delete and re-create your library from scratch.</strong>
                                    </details>
                                </div>
                            </div>
                            <div class="selectContainer selectContainer-withDescription">
                                <label class="selectLabel" for="LibraryFiltering">Library Filtering:</label>
                                <select is="emby-select" id="LibraryFiltering" name="LibraryFiltering" class="emby-select-withcolor emby-select">
                                    <option value="null">Auto</option>
                                    <option value="true" selected>Strict</option>
                                    <option value="false">Disabled</option>
                                </select>
                                <div class="fieldDescription">
                                    <div>Choose how the plugin filters out videos in your new libraries. This option only applies if the VFS is not used.</div>
                                    <details style="margin-top: 0.5em">
                                        <summary style="margin-bottom: 0.25em">What does auto filtering entail?</summary>
                                        Auto filtering means the plugin will only filter out unrecognized videos if no other metadata provider is enabled, otherwise it will leave them in the library.
                                    </details>
                                    <details style="margin-top: 0.5em">
                                        <summary style="margin-bottom: 0.25em">What does strict filtering entail?</summary>
                                        Strict filtering means the plugin will filter out any and all unrecognized videos from the library.
                                    </details>
                                    <details style="margin-top: 0.5em">
                                        <summary style="margin-bottom: 0.25em">What does disabling filtering entail?</summary>
                                        Disabling the filtering means the plugin will not filter out anything from the library. Use this only if you're having trouble.
                                    </details>
                                </div>
                            </div>
                        </div>
                        <div id="MediaFolderPerFolderSettingsContainer" hidden>
                            <div class="inputContainer inputContainer-withDescription">
                                <input is="emby-input" type="text" id="MediaFolderImportFolderName" label="Mapped Import Folder:" disabled readonly value="-" />
                                <div class="fieldDescription">The Shoko Import Folder the Media Folder is mapped to.</div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="MediaFolderVirtualFileSystem" />
                                    <span>Virtual File System&trade;</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">
                                    <div>Enables the use of the Virtual File System&trade; for the library.</div>
                                    <div id="WindowsSymLinkWarning2" hidden><strong>Warning</strong>: Windows users are required to <a href="https://learn.microsoft.com/en-us/windows/apps/get-started/developer-mode-features-and-debugging#use-regedit-to-enable-your-device" target="_blank" rel="noopener noreferrer">enable Developer Mode</a> then restart Jellyfin to be able to create symbolic links, a feature <strong>required</strong> to use the VFS.</div>
                                    <details style="margin-top: 0.5em">
                                        <summary style="margin-bottom: 0.25em">What does this mean?</summary>
                                        Enabling this setting should in theory make it so you won't have to think about file structure incompatibilities, since it will override your existing file structure and replace it with a layer of symbolic links managed by the plugin instead of your actual file structure.
                                        &nbsp;
                                        <strong>Do not enable this for an existing library. If you do, then delete and re-create your library from scratch.</strong>
                                    </details>
                                </div>
                            </div>
                            <div class="selectContainer selectContainer-withDescription">
                                <label class="selectLabel" for="MediaFolderLibraryFiltering">Library Filtering:</label>
                                <select is="emby-select" id="MediaFolderLibraryFiltering" name="MediaFolderLibraryFilteringMode" class="emby-select-withcolor emby-select">
                                    <option value="null">Auto</option>
                                    <option value="true" selected>Strict</option>
                                    <option value="false">Disabled</option>
                                </select>
                                <div class="fieldDescription">
                                    <div>Choose how the plugin filters out videos in your library. This option only applies if the VFS is not used.</div>
                                    <details style="margin-top: 0.5em">
                                        <summary style="margin-bottom: 0.25em">What does auto filtering entail?</summary>
                                        Auto filtering means the plugin will only filter out unrecognized videos if no other metadata provider is enabled, otherwise it will leave them in the library.
                                    </details>
                                    <details style="margin-top: 0.5em">
                                        <summary style="margin-bottom: 0.25em">What does strict filtering entail?</summary>
                                        Strict filtering means the plugin will filter out any and all unrecognized videos from the library.
                                    </details>
                                    <details style="margin-top: 0.5em">
                                        <summary style="margin-bottom: 0.25em">What does disabling filtering entail?</summary>
                                        Disabling the filtering means the plugin will not filter out anything from the library. Use this only if you're having trouble.
                                    </details>
                                </div>
                            </div>
                        </div>
                        <button is="emby-button" type="submit" name="media-folder-settings" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </fieldset>
                    <fieldset id="SignalRSection1" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>SignalR Connection</h3>
                        </legend>
                        <div class="inputContainer inputContainer-withDescription">
                            <input is="emby-input" type="text" id="SignalRStatus" label="Status:" disabled readonly value="Inactive">
                            <div class="fieldDescription">SignalR connection status.</div>
                        </div>
                        <div id="SignalRConnectContainer" hidden>
                            <button id="SignalRConnectButton" is="emby-button" type="submit" name="signalr-connect" class="raised button-submit block emby-button" disabled>
                                <span>Connect</span>
                            </button>
                            <div class="fieldDescription">Establish a SignalR connection to Shoko Server.</div>
                        </div>
                        <div id="SignalRDisconnectContainer">
                            <button is="emby-button" type="submit" name="signalr-disconnect" class="raised block emby-button">
                                <span>Disconnect</span>
                            </button>
                            <div class="fieldDescription">Terminate the SignalR connection to Shoko Server.</div>
                        </div>
                    </fieldset>
                    <fieldset id="SignalRSection2" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>SignalR Settings</h3>
                        </legend>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="SignalRAutoConnect" />
                                <span>Auto Connect On Start</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">
                                Automatically establish a SignalR connection to Shoko Server when Jellyfin starts.
                            </div>
                        </div>
                        <div class="inputContainer inputContainer-withDescription">
                            <input is="emby-input" type="text" id="SignalRAutoReconnectIntervals" label="Auto Reconnect Intervals:" />
                            <div class="fieldDescription">A comma separated list of intervals in seconds to try re-establish the connection if the plugin gets disconnected from Shoko Server.</div>
                        </div>
                        <div class="selectContainer selectContainer-withDescription">
                            <label class="selectLabel" for="SignalRMediaFolderSelector">Configure settings for:</label>
                            <select is="emby-select" id="SignalRMediaFolderSelector" name="SignalRMediaFolderSelector" value="" class="emby-select-withcolor emby-select">
                                <option value="">Default settings for new media folders</option>
                            </select>
                            <div class="fieldDescription selectFieldDescription">Select a media folder to add or modify the SignalR settings for.</div>
                        </div>
                        <div id="SignalRMediaFolderDefaultSettingsContainer">
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SignalRDefaultFileEvents" />
                                    <span>File Events</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">
                                    <div>Enable the SignalR file events for any new media folders.</div>
                                </div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SignalRDefaultRefreshEvents" />
                                    <span>Metadata Update Events</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">
                                    <div>Enable the SignalR metadata update events for any new media folders.</div>
                                </div>
                            </div>
                        </div>
                        <div id="SignalRMediaFolderPerFolderSettingsContainer" hidden>
                            <div class="inputContainer inputContainer-withDescription">
                                <input is="emby-input" type="text" id="SignalRMediaFolderImportFolderName" label="Mapped Import Folder:" disabled readonly value="-" />
                                <div class="fieldDescription">The Shoko Import Folder the Media Folder is mapped to.</div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SignalRFileEvents" />
                                    <span>File Events</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">
                                    <div>Enable the SignalR file events for the media folder.</div>
                                </div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SignalRRefreshEvents" />
                                    <span>Refresh Events</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">
                                    <div>Enable the SignalR metadata update events for the media folder.</div>
                                </div>
                            </div>
                        </div>
                        <button is="emby-button" type="submit" name="signalr-settings" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </fieldset>
                    <fieldset id="UserSection" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>User Settings</h3>
                        </legend>
                        <div class="selectContainer selectContainer-withDescription">
                            <label class="selectLabel" for="UserSelector">Configure settings for:</label>
                            <select is="emby-select" id="UserSelector" name="UserSelector" value="" class="emby-select-withcolor emby-select">
                                <option value="">Click here to select a user</option>
                            </select>
                            <div class="fieldDescription selectFieldDescription">Select a user to add, modify or delete the user settings for.</div>
                        </div>
                        <div id="UserSettingsContainer" hidden>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="UserEnableSynchronization" />
                                    <span>Enable synchronization features</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">Enabling this setting is mandatory to enable the sync features below. Select the sync feature you would like to use by enabling the checkbox.</div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SyncUserDataOnImport" />
                                    <span>Sync watch-state on import or refresh</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">Enabling this setting will import the watch-state for items from Shoko on import or refresh.</div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SyncUserDataAfterPlayback" />
                                    <span>Sync watch-state after playback</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">Enabling this setting will sync-back the watch-state to Shoko after playback has ended.</div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SyncUserDataUnderPlayback" />
                                    <span>Sync watch-state events during playback</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">Enabling this setting will sync-back the watch-state to Shoko on every play/pause/resume/stop event during playback.</div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SyncUserDataUnderPlaybackLive" />
                                    <span>Sync watch-state live during playback</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">Enabling this setting will sync-back the watch-state to Shoko live during playback.</div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SyncUserDataInitialSkipEventCount" />
                                    <span>Lazy sync watch-state events with shoko</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">Enabling this setting will add a safe buffer of 10 seconds of playback before the plugin will start the sync-back to shoko. This will prevent accidential clicks and/or previews from marking the file as watched in shoko, and will also keep them more in sync with jellyfin, since it's closer to how Jellyfin handles the watch-state internally.</div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input is="emby-checkbox" type="checkbox" id="SyncRestrictedVideos" />
                                    <span>Sync watch-state for restricted videos</span>
                                </label>
                                <div class="fieldDescription checkboxFieldDescription">Enabling this setting will sync-back the watch-state to Shoko for restricted videos (H).</div>
                            </div>
                            <div class="inputContainer inputContainer-withDescription">
                                <input is="emby-input" type="text" id="UserUsername" label="Username:" />
                                <div class="fieldDescription">The username of the account to synchronize with the currently selected user.</div>
                            </div>
                            <div id="UserPasswordContainer" class="inputContainer inputContainer-withDescription">
                                <input is="emby-input" type="password" id="UserPassword" label="Password:" />
                                <div class="fieldDescription">The password for account. It can be empty.</div>
                            </div>
                            <div id="UserDeleteContainer" class="inputContainer inputContainer-withDescription" hidden>
                                <button is="emby-button" type="submit" name="unlink-user" class="raised button-delete block emby-button">
                                    <span>Delete</span>
                                </button>
                                <div class="fieldDescription">This will delete any saved settings for the user.</div>
                            </div>
                            <button is="emby-button" type="submit" name="user-settings" class="raised button-submit block emby-button">
                                <span>Save</span>
                            </button>
                        </div>
                    </fieldset>
                    <fieldset id="TagSection" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>Tag Settings</h3>
                        </legend>
                        <div class="checkboxContainer">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="HideUnverifiedTags" />
                                <span>Hide unverified tags.</span>
                            </label>
                        </div>
                        <div class="checkboxContainer">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="HideArtStyleTags" />
                                <span>Hide art style related tags</span>
                            </label>
                        </div>
                        <div class="checkboxContainer">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="HideMiscTags" />
                                <span>Hide misc info tags that may be useful</span>
                            </label>
                        </div>
                        <div class="checkboxContainer">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="HidePlotTags" />
                                <span>Hide potentially plot-spoiling tags</span>
                            </label>
                        </div>
                        <div class="checkboxContainer">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="HideAniDbTags" />
                                <span>Hide any miscellaneous tags</span>
                            </label>
                        </div>
                        <div class="checkboxContainer">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="HideSettingTags" />
                                <span>Hide any tags related to the setting — a time or place in which the story occurs.</span>
                            </label>
                        </div>
                        <div class="checkboxContainer">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="HideProgrammingTags" />
                                <span>Hide any tags that involve how or where it aired, or any awards it got</span>
                            </label>
                        </div>
                        <button is="emby-button" type="submit" name="settings" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </fieldset>
                    <fieldset id="ProviderSection" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>Plugin Compatibility Settings</h3>
                        </legend>
                        <div class="fieldDescription verticalSection-extrabottompadding">
                            We can optionally set some ids for interoperability with other plugins.
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="AddAniDBId" />
                                <span>Add AniDB IDs</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">Enabling this will add the AniDB ID for all supported item types where an ID is available.</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="AddTMDBId" />
                                <span>Add TMDB IDs</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription">Enabling this will add the TMDB ID for all supported item types where an ID is available.</div>
                        </div>
                        <button is="emby-button" type="submit" name="settings" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </fieldset>
                    <fieldset id="AdvancedSection" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>Advanced Settings</h3>
                        </legend>
                        <div class="inputContainer inputContainer-withDescription">
                            <input is="emby-input" type="text" id="PublicUrl" label="Public Shoko host URL:" />
                            <div class="fieldDescription">This is the public URL leading to where Shoko is running. It can be used to redirect to Shoko if you click on a Shoko ID in the UI if Shoko and/or Jellyfin is running within a container and you cannot access Shoko from the host URL provided in the connection settings section above. If provided, then it should also be possible for Jellyfin to use the URL to access shoko, since this will be needed to grab images from the Shoko instance. It should include both the protocol and the IP/DNS name.</div>
                        </div>
                        <div class="inputContainer inputContainer-withDescription">
                            <input is="emby-input" type="text" id="IgnoredFolders" label="Ignored folder names:" />
                            <div class="fieldDescription">A comma separated list of folder names which will be ignored during the library scan.</div>
                        </div>
                        <button is="emby-button" type="submit" name="settings" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </fieldset>
                    <fieldset id="ExperimentalSection" class="verticalSection verticalSection-extrabottompadding" hidden>
                        <legend>
                            <h3>Experimental Settings</h3>
                        </legend>
                        <div class="fieldDescription verticalSection-extrabottompadding">Any features/settings in this section is still considered to be in an experimental state. <strong>You can enable them, but at the risk if them messing up your library.</strong></div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="EXPERIMENTAL_AutoMergeVersions" />
                                <span>Automatically merge multiple versions</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription"><div>Automatically merge multiple versions of the same item together after a library scan. Only applies to items with a Shoko ID set.</div></div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="EXPERIMENTAL_SplitThenMergeMovies" />
                                <span>Always split existing versions of movies before merging multiple versions</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription"><div>Always split existing merged items before starting the merge.</div><details style="margin-top: 0.5em"><summary style="margin-bottom: 0.25em">What is this setting for?</summary>Enabling this setting will make sure there will be no merge conflicts by splitting up all the existing merged versions. It will probably also make the plugin do a lot of unneeded work 99.5% of the time, but will help for the last 0.5% that actually need this to be done before every merge. An example is ensuring multiple parts of a movie series (e.g. "Part 1", "Part 2", etc.) are not merged in core Jellyfin because they contain the same Shoko Series Id.</details></div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="EXPERIMENTAL_SplitThenMergeEpisodes" />
                                <span>Always split existing versions of episodes before merging multiple versions</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription"><div>Always split existing merged items before starting the merge.</div><details style="margin-top: 0.5em"><summary style="margin-bottom: 0.25em">What is this setting for?</summary>Enabling this setting will make sure there will be no merge conflicts by splitting up all the existing merged versions. It will probably also make the plugin do a lot of unneeded work 99.5% of the time, but will help for the last 0.5% that actually need this to be done before every merge.</details></div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input is="emby-checkbox" type="checkbox" id="EXPERIMENTAL_MergeSeasons" />
                                <span>Automatically merge cour seasons</span>
                            </label>
                            <div class="fieldDescription checkboxFieldDescription"><div>Coming soon&trade; to a media library near you.</div></div>
                        </div>
                        <button is="emby-button" type="submit" name="settings" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </fieldset>
                </div>
            </form>
        </div>
    </div>
</div>
